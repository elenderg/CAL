To get an drive name for an path:
  Privatize the path.
  Null terminate the path.
  Put 512 into an length.
  Reassign an buffer's first given the length.
  Call "kernel32.dll" "GetVolumeInformationA" with the path's first and the buffer's first and the length and 0 and 0 and 0 and 0 and 0 returning an number.
  If the number is 0, clear the drive name; exit.
  Convert the buffer's first as an pchar to the drive name.
  
  