To create the hpen of an canvas given an color:
  Convert the color to an colorref.
  If the color is clear, put the null hpen into an hpen.
  Put the tpp times the pen size into an number.
  If the canvas is the printer canvas, put 1/96 inch times the pen size into the number.
  If the color is not clear, call "gdi32.dll" "CreatePen" with 0 [ps_solid] and the number and the colorref returning the hpen. 
  Call "gdi32.dll" "SelectObject" with the canvas and the hpen.
  
  