To lowercase any selected bytes in an text:
  If the text is nil, exit.
  Loop.
  Get an row from the text's rows.
  If the row is nil, exit.
  If the row of the text is not selected, repeat.
  Slap an substring on any selected bytes in the row of the text.  
  Lowercase the substring.
  Repeat.
  
  